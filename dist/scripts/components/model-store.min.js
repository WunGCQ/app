define("ModelStore",["CONF","promise","utils"],function(e,t,o){function n(e){this.conf=e,this.items={}}var i=e("promise"),r=e("utils");return n.prototype.getOne=function(e){var t=new i.Defer,o=this.items,n=o[e],s=this.conf.getOne,c=s.url+"/"+e;return n?t.resolve(n):(s.queries&&(c=r.appendQueries(c,s.queries)),axios.get(c).then(function(i){n=i.data.data,o[e]=n,t.resolve(n)},function(e){t.reject(e)})),t.promise},n.prototype.deleteOne=function(e){var t=this,o=new i.Defer,n=this.conf.deleteOne,r=n.url+"/"+e;return axios["delete"](r).then(function(n){console.log(n),t.deleteLocalOne(e),o.resolve(n.data)},function(e){o.reject(e)}),o.promise},n.prototype.saveOne=function(e){e=e||{};var t=this.items,o=new i.Defer,n=this.conf.saveOne,s=e._id,c=s?"put":"post",p=n.url+"/"+(s||"");return n.params&&(e=r.merge(n.params,e)),console.log(e),axios[c](p,e).then(function(n){e=n.data,t[e._id]=e,o.resolve(e)},function(e){o.reject(e)}),o.promise},n.prototype.createOne=n.prototype.saveOne,n.prototype.copyOne=function(e){return r.clone(e)},n.prototype.updateLocalOne=function(e){var t=e._id,o=this.items;o[t]&&(o[t]=e)},n.prototype.deleteLocalOne=function(e){e="object"==typeof e?e._id:e,this.items[e]&&delete this.items[e]},n});