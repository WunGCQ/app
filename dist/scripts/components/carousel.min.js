define("carousel",["node","promise"],function(t,e,i){function n(t,e){t="string"==typeof t?c(t).getDOMNode():t,this.conf=e||n.CONF,this.dom=t,this.indicators=d.map.call(t.lastElementChild.children,function(t){return new s(t,this)},this),this.slides=d.map.call(t.firstElementChild.children,function(t,e){return new o(t,this.indicators[e],this)},this),this.currentIndex=0,this.init()}function o(t,e,i){var n=t.style;if(this.dom=t,this.carousel=i,this.indicator=e,0===d.indexOf.call(t.parentElement.children,t))e.active();else{var o="translateX(100%)";n.webkitTransform=o,n.mozTransform=o,n.transform=o}n.opacity=1,this.subLayers=d.map.call(t.querySelectorAll(".carousel__slide__sublayer"),function(t){return new r(t)})}function r(t){this.dom=t}function s(t){this.dom=t}var a,c=t("node"),u=t("promise"),l=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,d=Array.prototype;return o.ANIM={},n.CONF={DUR:2600,TD:800},a=o.prototype,a.trans=function(t){function e(t){t||(t=+new Date),a.update(t),a.done||l(e)}var i=this,n=new u.Defer,o=n.promise,r={},s={};r.tx=2>=t?0:3===t?-100:100,r.op=2>=t?1:0,s.tx=t>=2?0:1===t?-100:100,s.op=t>=2?1:0,t>2?this.indicator.active():this.indicator.inActive();var a=new TWEEN.Tween(r);return a.to(s,i.carousel.conf.TD).onUpdate(function(){i.updateSlide(this)}).onComplete(function(){a.done=!0,n.resolve()}).start(),l(e),o},a.updateSlide=function(t){console.log(t);var e=this.dom.style,i="translateX("+t.tx+"%)";e.webkitTransform=i,e.mozTransform=i,e.transform=i},a=s.prototype,a.active=function(){this.dom.classList.add("carousel__slide__indicator--active")},a.inActive=function(){this.dom.classList.remove("carousel__slide__indicator--active")},a=n.prototype,a.init=function(){this.loop()},a.loop=function(){var t=this;t.timer=setTimeout(function(){t.next().then(function(){t.loop()})},t.conf.DUR)},a.go=function(t){var e=this.slides.length,i=this.slides[this.currentIndex],n=t>this.currentIndex;t=(t+e)%e,this.currentIndex=t;var o=this.slides[t],r=o.trans(n?4:3),s=i.trans(n?1:2);return u.all([r,s])},a.pre=function(){return this.go(this.currentIndex-1)},a.next=function(){return this.go(this.currentIndex+1)},a.pause=function(){clearTimeout(this.timer)},a.resume=a.loop,n});