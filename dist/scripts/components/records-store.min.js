define("RecordStore",["CONF","promise","utils"],function(e,t,o){function n(e){this.conf=e,this.records={},this.categories={}}function r(e){var t=[],o=s.keys(e);return s.each(o,function(o){t.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]))}),t.join("&")}var i=e("promise"),s=e("utils");return n.prototype.getOne=function(e){var t=new i.Defer,o=this.records,n=o[e],s=this.conf.getOne,c=s.url+"/"+e;return s.query&&(c=c+"?"+r(s.query)),n?t.resolve(n):axios.get(c).then(function(r){n=r.data,o[e]=n,t.resolve(n)},function(e){t.reject(e)}),t.promise},n.prototype.deleteOne=function(e){var t=this,o=new i.Defer,n=this.APIS.deleteOne+"/"+e;return axios["delete"](n).then(function(n){console.log(n),t.deleteLocalOne(e),o.resolve(n.data)},function(e){o.reject(e)}),o.promise},n.prototype.saveOne=function(e){var t=this.records,o=new i.Defer,n=e&&e._id,r=n?"put":"post",s=this.APIS.saveOne+"/"+(n||"");return axios[r](s,e).then(function(e){var r=e.data;t[n]=r,o.resolve(r)},function(e){o.reject(e)}),o.promise},n.prototype.createOne=n.prototype.saveOne,n.prototype.copyOne=function(e){return s.clone(e)},n.prototype.updataLocalOne=function(e){var t=e._id,o=this.records;o[t]&&(o[t]=e)},n.prototype.deleteLocalOne=function(e){e="object"==typeof e?e._id:e,this.records[e]&&delete this.records[e]},n.prototype.getPage=function(e,t){var o=new i.Defer,n=this.pages,r=n[e],s=this.APIS.getPage+"?page="+e+"&archive="+t;return r?o.resolve(r):axios.get(s).then(function(i){r=i.data,r._isArchived=t,n[e]=r,o.resolve(r)},function(e){o.reject(e)}),o.promise},n});