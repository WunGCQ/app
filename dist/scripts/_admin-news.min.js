require(["node","io","CONF","NewsManager","tooltip","toast"],function(t,e,n,i,o,d){function r(t){var e=document.querySelector("#ueditor-container").getBoundingClientRect(),n=UE.getEditor(t,{initialFrameWidth:e.width,initialFrameHeight:e.height-120,initialContent:"新闻内容"});return window.ue=n,n.ready(function(){u()}),n}function c(e){var n=t("<li>");n.text(e.title).attr("data-id",e._id).addClass("records-list__item"),b.prepend(n)}function a(t){(!C||C._id!==t._id||l())&&(v.val()!==t.title&&v.val(t.title),m.getContent()!==t.content&&m.setContent(t.content),C=t),C._id&&m.execCommand("serverparam","_id",C._id)}function l(){return C?C.title!==v.val()||C.content!==m.getContent():!1}function u(){v.attr("disabled","disabled"),m.setDisabled()}function s(){v.removeAttr("disabled"),m.setEnabled()}function f(t){t.removeAttr("disabled"),t.text(t.attr("data-enabled-text"))}function g(t){t.attr("disabled","disabled"),t.text(t.attr("data-disabled-text"))}var b=t.one("#records-list"),v=t.one("#record-title-input"),m=r("ueditor"),h=t.one("#record-publish-btn"),p=t.one("#record-create-btn"),_=t.one("#record-draft-btn"),C=null;p.on("click",function(){C&&l()?confirm("modified. save?"):i.createRecord().then(function(t){a(t),c(t),s()},function(t){})}),h.on("click",function(t){if(C&&l()){var e=i.copyRecord(C);e.content=m.getContent(),e.title=v.val(),g(h),i.saveRecrod(e).then(function(t){a(t),f(h)},function(t){console.log(t),f(h)})}}),_.on("click",function(){g(_),setTimeout(function(){f(_)},2e3)}),b.delegate("click",".records-list__item",function(e){var n=t(e.target).attr("data-id");i.getRecord(n).then(function(t){s(),a(t)},function(t){console.log(t)})}),b.delegate("click",".record-delete-btn",function(e){e.stopPropagation();var n=t.one(e.target),o=n.attr("data-id");i.deleteRecord(o).then(function(t){console.log(t)},function(t){console.log(t)})}),o.init(),window.Tooltip=o});